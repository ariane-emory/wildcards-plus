// =======================================================================================
// use wildcards to randomize some parts of the configuration before we get on with the
// actual textual content of the prompt:
// =======================================================================================

// %single-pick-prioritizes({ true_randomness })
// %revert-single-pick-prioritizes
// %multi-pick-prioritizes(true_randomness)
// %revert-multi-pick-prioritizes

// ---------------------------------------------------------------------------------------
// template config flags to enable model families or other features:
// ---------------------------------------------------------------------------------------

%config.loras([])

#flux_on
#hidream_full_on
// #hidream_fast_on

#square_on

// ---------------------------------------------------------------------------------------

// @lora_names :=
// { mj52_v2.0
// | ethereon
// | trendcraft_the_peoples_style_detailer_v2.1a_3_12_2025_sdxl
// | add_detail_xl
// | detailed_notrigger
// | xl_more_art_full_v1
// }

// named wildcard that expands into A1111-style lora expressions using one of the @lora_names.
// @lora := { <lora:@lora_names: @low_random_weight> }

{ 2 ?flux_on
  %config.model    ("flux_1_dev_q8p.ckpt")
  %config.steps    (50)
  %config.sampler  ({ "DDIM Trailing" | "Euler A" | "Euler A Trailing" })
  %config.cfg_scale({ \1.0 | \1.5 | \2.0 | \2.5 })
  %config.shift    ({ 1.10 | 1.20 | 1.30 | 1.40 | 1.50 })
  
  // possible resolutions:
  { 3 %config({ "width": 1600, "height": 768 })
  | 3 %config({ "width": 1280, "height": 640 })
  | 3 %config({ "width": 1024, "height": 512 })
  // | 3 %config({ "width": 768,  "height": 384 })
  // | 3 %config({ "width": 640,  "height": 320 })

  | 3 ?square_on %config({ "width": 1024,  "height": 1024 })
  | 3 ?square_on %config({ "width": 768,   "height": 768 })
  // | 3 ?square_on %config({ "width": 640,   "height": 640 })
  // | 3 ?square_on %config({ "width": 512,   "height": 512 })
  }

| 2 ?hidream_fast_on,hidream_full_on

  // Hidream with some basic settings that seem to work alright:
  %config.model    ({ ?hidream_fast_on "hidream_i1_fast_q5p.ckpt"
                    | ?hidream_full_on "hidream_i1_full_q5p.ckpt" })  
  %config.steps    (50)
  %config.sampler  ({ "DDIM Trailing" | "Euler A" | "Euler A Trailing" })
  %config.cfg_scale({ 8 5.0  | 7 10.0 | 6 15.0 | 5 20.0 | 4 25.0 | 3 30.0 | 2 35.0 | 1 40.0})
  %config.shift    ({ 1.10 | 1.20 | 1.30 | 1.40 | 1.50 })

  // possible resolutions:
  { 3 %config({ "width": 1600, "height": 768 })
  | 3 %config({ "width": 1280, "height": 640 })
  | 3 %config({ "width": 1024, "height": 512 })
  // | 3 %config({ "width": 768,  "height": 384 })
  // | 3 %config({ "width": 640,  "height": 320 })

  | 3 ?square_on %config({ "width": 1024,  "height": 1024 })
  | 3 ?square_on %config({ "width": 768,   "height": 768 })
  // | 3 ?square_on %config({ "width": 640,   "height": 640 })
  // | 3 ?square_on %config({ "width": 512,   "height": 512 })
  }
}

// Chance of 'artsy' mode:
// {|3 #artsy}
#artsy

// =======================================================================================
// make random sci-fi characters:
// =======================================================================================

{#planet|#ship|#moon|#station} // where are we?

@pro_pos_rand  := {2 @pro_pos_adj|a}
@setting_word  := {?planet 2 planet|?moon 2 moon|?ship ship|?station station}

@ship_term     := {starship|spacecraft|space ship|shuttle}
@ship_late_adj := {space|interstellar}
@ship_term2    := {starship|spacecraft|@ship_late_adj ship|{|interplanetary} shuttle
                  |@ship_late_adj frigate
                  |@ship_late_adj battleship|@ship_late_adj destroyer
                  |{|@ship_late_adj} merchant vessel
                  |{|@ship_late_adj} freighter
                  |{|@ship_late_adj} liner
                  |{|@ship_late_adj} vessel}

// ---------------------------------------------------------------------------------------
// 'level 2' places, for phrases like 'in $place in a $largerPlace':
// ---------------------------------------------------------------------------------------
@l2_place     := {on a @l2_place_adj {?ship @ship_term2|?station space station
                 |?planet planet|?planet world|?moon moon}}
@l2_place_adj := 
{
|strange
|exotic
|!#crowded crowded
|!#busy busy 
|remote
|secluded
|run-down
|!#advanced advanced
|primitive
|backwater
|!#highly-detailed highly-detailed
|!#greebled {|highly} greebled
}
@l2_orbit_obj_adj   := {dim|distant|huge|luminous|shining}
@l2_orbit_obj       := {2 !planet {|ringed} planet|!planet !moon ship
                       |!planet !moon space station|!planet !moon asteroid
                       |!planet comet|2 {|2 yellow|2 red|green} star|black hole
                       |!planet !moon satellite}
@l2_orbit_phrase    := {@l2_orbit_obj_adj @l2_orbit_obj}
@l2_place_phrase    := {@l2_place {|2 orbiting a @l2_orbit_phrase}}

// ---------------------------------------------------------------------------------------
// places to be 'in' or 'at':
// ---------------------------------------------------------------------------------------
@place_to_be_in := 
{2 #indoors  {2 crew cabin 
             |bar
             |control room
             |corridor
             |equipment room
             |laboratory
             |lounge
             |workshop
             |factory
             |security room
             |?station 2 market
             |?planet,moon #vehicle air/raft
             |?planet,moon #vehicle aerodyne
             |?planet,moon #vehicle {sky|hover|grav|air} {<car|transport|vehicle}
             |?planet,moon #vehicle {ground|all-terrain\ |combat\ }
                                    {<car|transport|vehicle}             
             |?ship,station 2 cockpit
             |?ship,station engine room
             |?ship,station airlock
             |?ship,station cargo bay
             |?ship,station docking bay
             |?ship @ship_term<'s bridge
             |{access|maintenance} tunnel
             }
|4 ?planet,moon #outdoors {alley
                        |{|2 hive city|2 megacity|2 arcology} street
                        |crater
                        |bazaar
                        |market
                        }
}
@place_to_be_at :=
{{ware|store} #indoors <house
|?planet,moon alien ruin
|abandoned wreck of a @ship_term2
|{2|holographic} computer
|?planet,moon #outdoors colony
|holographic #indoors projector
|?planet,moon #outdoors launch pad
|?ship,station #indoors helm
|?ship,station 2 #indoors {|navigation|control|sensor|computer} console
}
@place_to_be_in_adj :=
{3
|!vehicle !#busy busy
|!vehicle !#crowded crowded
|messy
|noisy
|cluttered
|neon-lit
|?outdoors torchlit
|?outdoors 2 smoky
|?outdoors foggy
}
@place_phrase := {2 in {a|the} @#place_to_be_in @place_to_be_in_adj @place_to_be_in
                 |at {a|the} @#place_to_be_at @place_to_be_at}

// ---------------------------------------------------------------------------------------
// character adjectives:
// ---------------------------------------------------------------------------------------
@char_early_adj :=
{adventurous
|androgynous
|?neuter 2 androgynous
|mysterious
|solitary #solo
|inscrutable
|independant #solo
|daring
|resolute
|brave
|cunning
|inhuman
|intimidating
|exotic
|otherworldly
|athletic
|muscular
|youthful
|beautiful
}
@char_late_adj :=
{4
|alien #alien
|android
|cyborg #cyborg
|human #human
|?traveller Vargr
|?traveller Vilani
|?traveller Zhodani
}

// ---------------------------------------------------------------------------------------
// weapons:
// ---------------------------------------------------------------------------------------
@weapon_phrase           := {@weapon_verb @pro_pos_rand {2 !melee @ranged_weapon|@melee_weapon}}
@weapon_verb             := {3 holding|wielding|brandishing|displaying|presenting}
@melee_weapon            := {{vibro|phase|energy|monomolecular|pulse}
                             {sword|blade|knife|dagger|baton}}
@ranged_weapon_early_adj := {|automatic|primitive|!#high-tech high-tech|!#advanced advanced|alien
                            |!#highly-detailed highly-detailed|!#greebled {|highly} greebled}
@ranged_weapon_late_adj  := {|laser|plasma|gauss|smart|pulse|combat|high-velocity|ion}
@ranged_weapon           := {@ranged_weapon_early_adj
                             @ranged_weapon_late_adj
                             {3 pistol|2 {|sniper|hunting} rifle|2 submachinegun|blaster
                             |{grenade|rocket} launcher|stunner|cannon|disintegrator}
                            }                

// ---------------------------------------------------------------------------------------
// tools:
// ---------------------------------------------------------------------------------------
@tool_adj    := {!#advanced advanced|intricate|alien|!#high-tech high-tech|holographic
                |!#highly-detailed highly-detailed|!#greebled {|highly} greebled}
@tool_phrase := {holding @pro_pos_rand @tool_adj @tool}
@tool :=
{hydrospanner
|2 probe
|2 scanner
|2 toolkit
|equipment
|instruments
|pair of binoculars
|telescope
|plasma cutter
|3 vacuum suit's helmet under one arm
|optical device
|tricorder
|cyberdeck
|2 datapad
|2 communicator
|1 radio
}

// ---------------------------------------------------------------------------------------
// inventory flags:
// ---------------------------------------------------------------------------------------
@maybe_no_equipment := {|2 #tool|#weapon}
@tool_or_weapon     := {#tool|#weapon}
@likely_weapon      := {#tool|2 #weapon}
@likely_tool        := {2 #tool|#weapon}

// ---------------------------------------------------------------------------------------
// roles/character types:
// ---------------------------------------------------------------------------------------
@role :=
{#weapon mercenary 
|{3|hyperdrive|@ship_term} technician          @likely_tool
|engineer                                      @likely_tool
|communications officer                        @maybe_no_equipment
|scientist                                     #tool
|explorer                                      @likely_tool
|scout                                         @tool_or_weapon
|wanderer                                      @tool_or_weapon
|{2|interstellar} bounty hunter                #weapon
|soldier                                       #weapon
|2 space pirate                                  #weapon
|trooper                                       #weapon
|prize fighter                                 #weapon #melee
|assassin                                      @likely_weapon
|medic                                         #tool
|cyberdoc                                      #tool
|worker                                        #tool
|{?traveller psion}                            @maybe_no_equipment
|2 {space|star|interstellar} {trader|merchant} @maybe_no_equipment #merchant
|{space|star} marine                           #weapon
|@ship_term captain                            @maybe_no_equipment
|@ship_term pilot                              @maybe_no_equipment
|{|@ship_term} {navigator|astrogator}          @maybe_no_equipment
}

// ---------------------------------------------------------------------------------------
// clothing:
// ---------------------------------------------------------------------------------------
@clothing_sentence := {@^pro_3rd_subj is @clothing_verb @clothing_type.}
@clothing_verb     := {2 wearing|clad in|dressed in}
@clothing_adj      := {2|1 futuristic|!#advanced advanced|tattered|dusty|!merchant millitary
                      |!#high-tech high-tech|#highly-detailed highly-detailed
                      |{|starship|space ship|spacecraft} crew members'
                      |!merchant !#greebled {|highly} greebled}
@clothing_type     := {?weapon {|@pro_pos_adj} @clothing_adj {|combat|power|space} armor
                      |@pro_pos_rand @clothing_adj flight suit
                      |@pro_pos_rand @clothing_adj body suit
                      |@pro_pos_rand @clothing_adj uniform
                      |3 ?merchant @pro_pos_rand @clothing_adj rich attire
                      |@pro_pos_rand @clothing_adj {|helmetless}
                                     {space|vacuum|hazardous environment} suit
                      |@pro_pos_rand @clothing_adj exoskeleton}
 
// ---------------------------------------------------------------------------------------
// cyborg features:
// ---------------------------------------------------------------------------------------
@cyborg_features := {{a|one} {bionic|mechanical} arm
                    |{bionic|mechanical} arms
                    |{a|one} {bionic|cyber {|<netic}} eye
                    |{bionic|cyber {|<netic}} eyes
                    }
@cyborg_feature_sentence       := {?cyborg !ecfs @^pro_3rd_subj has @cyborg_features . }
@early_cyborg_feature_sentence := {?cyborg #ecfs with @cyborg_features }

// ---------------------------------------------------------------------------------------
// ailen features:
// ---------------------------------------------------------------------------------------
@alien_features := {an insectoid appearance
                   |2 digitigrade legs
                   |gills on @pro_pos_adj throat
                   |!#alien_claws {{|razor} sharp|retractable} claws
                   |hooved feet
                   |!#alien_wings {|diaphanous|batlike} wings
                   |!#alien_horns {curling|back-curved} horns
                   |!#alien_skin chitinous armored plates on @pro_pos_adj skin
                   |!#alien_skin scaled skin
                   |!#alien_tail a {|2 prehensile|spined} tail
                   |!#alien_skin skin like an amphibian
                   |!#alien_eyes {two|three|four|six} eyes
                   |vicious fangs
                   |a slitted nose
                   |!#alien_eyes slitted eyes
                   |!#alien_eyes compound eyes
                   |four arms
                   |!#alien_skin {smooth|shiny} fur
                   |!#alien_quills quill {<-like|<s instead of} hair
                   |a reptilian appearance
                   }                   
@alien_feature_sentence       := {?alien !eafs @^pro_3rd_subj has @1-2&alien_features . }
@early_alien_feature_sentence := {?alien #eafs with @1-2&alien_features }

// ---------------------------------------------------------------------------------------
// things in the sky:
// ---------------------------------------------------------------------------------------
@late_sky_verb_frag       := {in the sky above|overhead}
@early_sky_verb_frag      := {can be seen|hangs|looms}
@early_sky_verb_frag_no_s := {can be seen|hang|loom}
@sky_sentence := {?outdoors {
2 {Two|Three} {3 moons|suns} @early_sky_verb_frag_no_s @late_sky_verb_frag.
|2 A {binary|trinary} { 2 star|sun} @early_sky_verb_frag @late_sky_verb_frag.
|3 ?moon The {planet|gas giant} that this @setting_word is orbiting @early_sky_verb_frag @late_sky_verb_frag. 
|The planet's ring can be seen arching over @late_sky_verb_frag.
|A descending @ship_term2 @early_sky_verb_frag @late_sky_verb_frag.
|A {planet|gas giant} @early_sky_verb_frag @late_sky_verb_frag.
|Falling meteors can be seen @late_sky_verb_frag.
|An orbiting space station @early_sky_verb_frag @late_sky_verb_frag.
|Strangely coloured lights @early_sky_verb_frag_no_s @late_sky_verb_frag.
|Strange lights {can be seen|hang} @late_sky_verb_frag.
|Flocks of {|2 alien} {2 birds|insects} can be seen @late_sky_verb_frag.
|Flying vehicles can be seen @late_sky_verb_frag.
|A {|huge|gigantic} {2 |2 red|2 yellow|green} {2 sun|star going {nova|supernova}} @early_sky_verb_frag @late_sky_verb_frag.
}}

// ---------------------------------------------------------------------------------------
// colour palette/lighting stuff:
// ---------------------------------------------------------------------------------------
@colour_modifiers := {warm color pallete|warm lighting|natural lighting|?outdoors golden hour}

// =======================================================================================
// generate the prompt body:
// =======================================================================================

{ #wizards_artist.helen_frankenthaler
| #wizards_artist.frank_frazetta
| #wizards_artist.boris_vallejo
| #wizards_artist.gerald_brom
| #wizards_artist.jack_gaughan 
| #wizards_artist.chris_foss
| #wizards_artist.peter_elson
| #wizards_artist.john_blanche
| #wizards_artist.wayne_barlowe
}

#wizards_artists_artist_is_set 

{2|@aris_defaults,}
science fiction,
{3|greebles,|greeblies,}
{|#traveller Traveller RPG,}
{|?traveller GDW,}
{|?traveller Third Imperium,}
{|futuristic,}
{2|hyperrealistic,}
{2|infinite focus,}
{|extremely detailed,}
{2|100-hour render time,}
{2|@0-2,colour_modifiers}
.

\n\n

A { ?artsy {masterpiece|piece|piece of art{|<work}} by @wizards_artists {which depicts|depicting} a }
// A { ?artsy {masterpiece|piece|piece of art{|<work}} by Helen Frankenthaler {which depicts|depicting} a }
@0-2&char_early_adj @char_late_adj @role
{2|@early_alien_feature_sentence}
{2|@early_cyborg_feature_sentence}
@place_phrase {|3 @l2_place_phrase|5 ?outdoors @l2_place_phrase}
{|6 ?weapon @weapon_phrase}
{|6 ?tool   @tool_phrase}
.

{|6 @clothing_sentence}
{|6 @cyborg_feature_sentence}
{|6 @alien_feature_sentence}
{|8 @sky_sentence}

{?artsy By @wizards_artists, @wizards_artist_styles. }
// abstract, abstract-expressionism, color-field, contemporary, expressionism, feminism, painting, printmaking, watercolor.

// #foo
// #foo.bar.baz

// \n

// { ?foo              FOO IS SET \n }
// { ?foo.bar          FOO.BAR IS SET \n }
// { ?foo.bar.baz      FOO.BAR.BAZ IS SET \n }
// { ?foo.bar.baz.quux FOO.BAR.BAZ.QUUX IS SET \n }

// #!foo.bar
// UNSET IT \n

// { ?foo              FOO IS SET \n }
// { ?foo.bar          FOO.BAR IS SET \n }
// { ?foo.bar.baz      FOO.BAR.BAZ IS SET \n }
// { ?foo.bar.baz.quux FOO.BAR.BAZ.QUUX IS SET \n }
